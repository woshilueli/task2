apply plugin: 'jacoco'

jacoco {
    toolVersion = "0.8.2"
}

test {
    jacoco {
        dumpOnExit = true
    }
}

jacocoTestReport {
    reports {
        xml.enabled false
        csv.enabled false
    }
    afterEvaluate {
        classDirectories = files(classDirectories.files.collect {
            fileTree(dir: it,
                    exclude: ['**/metrics/**'])
        })
    }
}
jacocoTestReport.group = 'Code Coverage'
jacocoTestReport.description = 'Run code coverage for all modules and all custom tasks'

check.dependsOn jacocoTestReport